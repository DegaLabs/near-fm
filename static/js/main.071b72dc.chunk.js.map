{"version":3,"sources":["App.js","pages/Home.js","images/near_vodka_logo.png","pages/Post.js","components/FollowTab.js","pages/Account.js","index.js","components/Followers.js","components/FollowButton.js","components/AccountCard.js","components/Feed.js","components/Account.js","components/NewPost.js","data/Post.js","components/AddStorageButton.js","components/Post.js","data/Account.js","pages/Discover.js"],"names":["NearConfig","window","location","hostname","networkId","nodeUrl","archivalNodeUrl","contractName","walletUrl","App","props","_near","blockViewCall","blockId","methodName","args","account","validateArgs","connection","lastBlockHeight","archivalConnection","provider","query","request_type","block_id","account_id","method_name","args_base64","Buffer","JSON","stringify","toString","result","length","parse","from","state","connected","isNavCollapsed","newPosts","followers","following","_initNear","then","setState","signedIn","accountId","signedAccountId","a","keyStore","nearAPI","BrowserLocalStorageKeyStore","Object","assign","deps","near","this","fromConfig","type","url","signer","walletConnection","getAccountId","block","finality","header","height","contract","viewMethods","changeMethods","storage_minimum_balance","storageMinimumBalance","accounts","getAccount","Promise","resolve","AccountData","load","cacheAccount","posts","getPost","blockHeight","key","PostData","accountData","fetchStorageBalance","fetchFollowings","followings","enoughStorageBalance","stats","fetchFollowers","e","preventDefault","requestSignIn","signOut","_accountId","passProps","updateState","s","className","onClick","logOut","role","aria-hidden","basename","process","to","title","src","NearVodkaLogo","alt","data-bs-toggle","data-bs-target","aria-controls","aria-expanded","aria-label","id","aria-current","href","data-ribbon","exact","path","React","Component","HomePage","useState","followingSeed","setFollowingSeed","useEffect","seed","entries","map","lastPostHeight","push","extraPosts","module","exports","PostPage","useParams","post","setPost","parseInt","FollowTab","setAccount","follow","setFollow","loading","setLoading","uuid","gkey","showFollowers","hidden","fetchAccount","useCallback","list","notFollowing","keys","filter","AccountCard","AccountPage","setSeed","aria-selected","aria-labelledby","NewPost","Feed","Followers","ReactDOM","render","document","getElementById","FollowButton","alert","unfollow","disabled","knownFollowers","setKnownFollowers","newFollowing","setNewFollowing","followsYou","setFollowsYou","slice","i","followersAndOthers","followingAndOthers","numPosts","numFollowing","numFollowers","setPosts","fetchPosts","recent","SortedSet","pop","feed","Account","setHidden","data-tip","data-for","border","borderColor","delayHide","delayShow","effect","afterShow","afterHide","body","setBody","_body","convertPost","placeholder","rows","value","onChange","target","time","Date","parseFloat","block_height","last_post_height","requestBlockHeight","_ready","fetch","AddStorageButton","storage_deposit","Post","datetime","MinEnoughStorageBalance","BN","convertAccountStats","accountStats","num_posts","num_followers","num_following","storage_balance_of","storageBalance","storageTotal","total","storageAvailable","available","get_account","followingsFetch","promises","get_following","from_index","limit","all","flat","forEach","followersFetch","get_followers","fetchAccountStats","DiscoverPage","fetchSeed","get_num_accounts","numAccounts","get_accounts","Math","max"],"mappings":"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","file":"static/js/main.071b72dc.chunk.js","sourcesContent":["import React from 'react';\nimport \"error-polyfill\";\nimport 'bootstrap/dist/js/bootstrap.bundle';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport \"./App.scss\";\nimport './gh-fork-ribbon.css';\nimport HomePage from \"./pages/Home\"\nimport AccountPage from \"./pages/Account\"\nimport {HashRouter as Router, Link, Route, Switch} from 'react-router-dom'\nimport * as nearAPI from 'near-api-js'\nimport {AccountData} from \"./data/Account\";\nimport NearVodkaLogo from \"./images/near_vodka_logo.png\"\nimport PostPage from \"./pages/Post\";\nimport {PostData} from \"./data/Post\";\nimport DiscoverPage from \"./pages/Discover\";\nimport AddStorageButton from \"./components/AddStorageButton\";\n\n// 4 epochs\nconst NumBlocksNonArchival = 4 * 12 * 3600;\n\nconst IsMainnet = window.location.hostname === \"near.vodka\";\nconst TestNearConfig = {\n  networkId: 'testnet',\n  nodeUrl: 'https://rpc.testnet.near.org',\n  archivalNodeUrl: 'https://rpc.testnet.internal.near.org',\n  contractName: 'dev-1613368835598-7014445',\n  walletUrl: 'https://wallet.testnet.near.org',\n};\n\nconst MainNearConfig = {\n  networkId: 'testnet',\n  nodeUrl: 'https://rpc.testnet.near.org',\n  archivalNodeUrl: 'https://rpc.testnet.internal.near.org',\n  contractName: 'dev-1613368835598-7014445',\n  walletUrl: 'https://wallet.testnet.near.org',\n};\n\n// const MainNearConfig = {\n//   networkId: 'mainnet',\n//   nodeUrl: 'https://rpc.mainnet.near.org',\n//   contractName: 'berryclub.ek.near',\n//   walletUrl: 'https://wallet.near.org',\n// };\nconst NearConfig = IsMainnet ? MainNearConfig : TestNearConfig;\n\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this._near = {\n      async blockViewCall(blockId, methodName, args) {\n        args = args || {};\n        this.account.validateArgs(args);\n        const connection = blockId + NumBlocksNonArchival < this.lastBlockHeight ?\n          this.archivalConnection :\n          this.account.connection;\n        const result = await connection.provider.query({\n          request_type: 'call_function',\n          block_id: blockId,\n          account_id: NearConfig.contractName,\n          method_name: methodName,\n          args_base64: new Buffer(JSON.stringify(args), 'utf8').toString('base64'),\n        });\n        return result.result && result.result.length > 0 && JSON.parse(Buffer.from(result.result).toString());\n      }\n    };\n\n    this.state = {\n      connected: false,\n      isNavCollapsed: true,\n      newPosts: [],\n      followers: {},\n      following: {},\n    };\n\n    this._initNear().then(() => {\n      this.setState({\n        signedIn: !!this._near.accountId,\n        signedAccountId: this._near.accountId,\n        connected: true,\n      });\n    });\n  }\n\n\n  async _initNear() {\n    const keyStore = new nearAPI.keyStores.BrowserLocalStorageKeyStore();\n    const near = await nearAPI.connect(Object.assign({deps: {keyStore}}, NearConfig));\n    this._near.archivalConnection = nearAPI.Connection.fromConfig({\n      networkId: NearConfig.networkId,\n      provider: { type: 'JsonRpcProvider', args: { url: NearConfig.archivalNodeUrl } },\n      signer: { type: 'InMemorySigner', keyStore }\n    });\n    this._near.keyStore = keyStore;\n    this._near.near = near;\n\n    this._near.walletConnection = new nearAPI.WalletConnection(near, NearConfig.contractName);\n    this._near.accountId = this._near.walletConnection.getAccountId();\n\n    this._near.account = this._near.walletConnection.account();\n    const block = await this._near.account.connection.provider.block({ finality: 'final' });\n    this._near.lastBlockHeight = block.header.height;\n    this._near.contract = new nearAPI.Contract(this._near.account, NearConfig.contractName, {\n      viewMethods: ['get_account', 'get_accounts', 'get_num_accounts', 'get_followers', 'get_following', 'get_post', 'storage_minimum_balance', 'storage_balance_of'],\n      changeMethods: ['storage_deposit', 'storage_withdraw', 'post', 'follow', 'unfollow'],\n    });\n    this._near.storageMinimumBalance = await this._near.contract.storage_minimum_balance();\n\n    this._near.accounts = {};\n    this._near.getAccount = (accountId) => {\n      if (accountId in this._near.accounts) {\n        return this._near.accounts[accountId];\n      }\n      return this._near.accounts[accountId] = Promise.resolve(AccountData.load(this._near, accountId));\n    };\n\n    this._near.cacheAccount = (accountId, account) => {\n      if (accountId in this._near.accounts) {\n        return;\n      }\n      this._near.accounts[accountId] = Promise.resolve(account);\n    };\n\n    this._near.posts = {};\n    this._near.getPost = (accountId, blockHeight) => {\n      const key = `${accountId}/${blockHeight}`;\n      if (key in this._near.posts) {\n        return this._near.posts[key];\n      }\n      return this._near.posts[key] = Promise.resolve(PostData.load(this._near, accountId, blockHeight));\n    };\n\n    if (this._near.accountId) {\n      this._near.accountData = await this._near.getAccount(this._near.accountId);\n      await this._near.accountData.fetchStorageBalance();\n      await this._near.accountData.fetchFollowings();\n      this.setState({\n        followings: Object.assign({}, this._near.accountData.followings),\n        enoughStorageBalance: this._near.accountData.stats.enoughStorageBalance,\n      });\n      this._near.accountData.fetchFollowers().then(() => {\n        this.setState({\n          followers: Object.assign({}, this._near.accountData.followers),\n        });\n      })\n    }\n  }\n\n\n  async requestSignIn(e) {\n    e.preventDefault();\n    const appTitle = 'NEAR Vodka';\n    await this._near.walletConnection.requestSignIn(\n      NearConfig.contractName,\n      appTitle\n    )\n    return false;\n  }\n\n  async logOut() {\n    this._near.walletConnection.signOut();\n    this._near.accountId = null;\n    this.setState({\n      signedIn: !!this._accountId,\n      signedAccountId: this._accountId,\n    })\n  }\n\n  render() {\n    const passProps = {\n      _near: this._near,\n      updateState: (s) => this.setState(s),\n      ...this.state\n    };\n    const header = !this.state.connected ? (\n      <div>Connecting... <span className=\"spinner-grow spinner-grow-sm\" role=\"status\" aria-hidden=\"true\"></span></div>\n    ) : (this.state.signedIn ? (\n      <div>\n        <AddStorageButton {...passProps}/>\n        <button\n          className=\"btn btn-outline-secondary\"\n          onClick={() => this.logOut()}>Sign out ({this.state.signedAccountId})</button>\n      </div>\n    ) : (\n      <div>\n        <button\n          className=\"btn btn-primary\"\n          onClick={(e) => this.requestSignIn(e)}>Sign in with NEAR Wallet</button>\n      </div>\n    ));\n\n    return (\n      <div className=\"App\">\n        <Router basename={process.env.PUBLIC_URL}>\n          <nav className=\"navbar navbar-expand-lg navbar-light bg-light mb-3\">\n            <div className=\"container-fluid\">\n              <Link className=\"navbar-brand\" to=\"/\" title=\"NEAR Vodka - connecting people\">\n                <img src={NearVodkaLogo} alt=\"NEAR Vodka\" className=\"d-inline-block align-middle\" />\n                [TESTNET] NEAR Vodka\n              </Link>\n              <button className=\"navbar-toggler\" type=\"button\" data-bs-toggle=\"collapse\"\n                      data-bs-target=\"#navbarSupportedContent\" aria-controls=\"navbarSupportedContent\"\n                      aria-expanded=\"false\" aria-label=\"Toggle navigation\">\n                <span className=\"navbar-toggler-icon\"></span>\n              </button>\n              <div className=\"collapse navbar-collapse\" id=\"navbarSupportedContent\">\n                <ul className=\"navbar-nav me-auto mb-2 mb-lg-0\">\n                  <li className=\"nav-item\">\n                    <Link className=\"nav-link\" aria-current=\"page\" to=\"/\">Home</Link>\n                  </li>\n                  {this.state.signedIn && (\n                    <li className=\"nav-item\">\n                      <Link className=\"nav-link\" aria-current=\"page\" to=\"/discover\">Discover</Link>\n                    </li>\n                  )}\n                  {this.state.signedIn && (\n                    <li className=\"nav-item\">\n                      <Link className=\"nav-link\" aria-current=\"page\"\n                            to={`/a/${this.state.signedAccountId}`}>Profile</Link>\n                    </li>\n                  )}\n                </ul>\n                <form className=\"d-flex\">\n                  {header}\n                </form>\n              </div>\n            </div>\n          </nav>\n\n          <a className=\"github-fork-ribbon right-bottom fixed\" href=\"https://github.com/evgenykuzyakov/near-vodka\" data-ribbon=\"Fork me on GitHub\"\n             title=\"Fork me on GitHub\">Fork me on GitHub</a>\n\n          <Switch>\n            <Route exact path={\"/\"}>\n              {this.state.signedIn ? (\n                <HomePage {...passProps}/>\n              ) : (\n                <DiscoverPage {...passProps}/>\n              )}\n            </Route>\n            <Route exact path={\"/discover\"}>\n              <DiscoverPage {...passProps}/>\n            </Route>\n            <Route exact path={\"/a/:accountId\"}>\n              <AccountPage {...passProps} />\n            </Route>\n            <Route exact path={\"/p/:accountId/:blockHeight\"}>\n              <PostPage {...passProps} />\n            </Route>\n          </Switch>\n        </Router>\n      </div>\n    )\n  }\n}\n\nexport default App;\n","import \"./Home.scss\";\nimport React, {useEffect, useState} from 'react';\nimport NewPost from \"../components/NewPost\";\nimport Feed from \"../components/Feed\";\nimport Followers from \"../components/Followers\";\nimport {Link} from \"react-router-dom\";\n\nfunction HomePage(props) {\n  const [followingSeed, setFollowingSeed] = useState(false);\n\n  useEffect(() => {\n    if (props.connected) {\n      const accountData = props._near.accountData;\n      if (accountData) {\n        const seed = Object.entries(props.followings).map(\n          ([accountId, account]) => [account.stats.lastPostHeight, accountId]\n        );\n        if (accountData.stats.lastPostHeight > 0) {\n          seed.push([accountData.stats.lastPostHeight, accountData.accountId]);\n        }\n        setFollowingSeed(seed);\n      } else {\n        setFollowingSeed([]);\n      }\n    }\n  }, [props.connected, props.followings, props._near.accountData])\n\n  return (\n    <div>\n      <div className=\"container\">\n        <div className=\"row justify-content-md-center\">\n          <div className=\"col col-12 col-lg-8 col-xl-6\">\n            <NewPost {...props}/>\n            {(followingSeed && followingSeed.length > 0) ? (\n              <div>\n                <h3>Your Feed</h3>\n                <Feed {...props} seed={followingSeed} extraPosts={props.newPosts}/>\n              </div>\n            ) : followingSeed ? (\n              <div>\n                <h3>Feed is empty</h3>\n                <div>\n                  <Link to={\"/discover\"} className=\"btn btn-outline-secondary\">Discover more</Link>\n                </div>\n              </div>\n            ) :  (\n              <div className=\"d-flex justify-content-center\">\n                <div className=\"spinner-grow\" role=\"status\">\n                  <span className=\"visually-hidden\">Loading...</span>\n                </div>\n              </div>\n            )}\n          </div>\n          <div className=\"col col-12 col-lg-4 col-xl-4\">\n            {props.signedIn && <Followers {...props} />}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default HomePage;\n","module.exports = __webpack_public_path__ + \"static/media/near_vodka_logo.f18e89c9.png\";","import React, {useState} from 'react';\nimport {useParams} from \"react-router\";\nimport Post from \"../components/Post\";\nimport Followers from \"../components/Followers\";\n\nfunction PostPage(props) {\n  const { accountId, blockHeight } = useParams();\n  const [post, setPost] = useState(false);\n\n  if (props.connected && props._near) {\n    props._near.getPost(accountId, parseInt(blockHeight)).then((post) => {\n      setPost(post);\n    })\n  }\n\n  return (\n    <div className=\"container\">\n      <div className=\"row justify-content-md-center\">\n        <div className=\"col col-12 col-lg-8 col-xl-6\">\n          {post ? (\n            <Post {...props} post={post}/>\n          ) : (\n            <div className=\"d-flex justify-content-center\">\n              <div className=\"spinner-grow\" role=\"status\">\n                <span className=\"visually-hidden\">Loading...</span>\n              </div>\n            </div>\n          )}\n        </div>\n        <div className=\"col col-12 col-lg-4 col-xl-4\">\n          {props.signedIn && <Followers {...props} />}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default PostPage;\n","import React, {useCallback, useEffect, useState} from 'react';\nimport uuid from \"react-uuid\";\nimport AccountCard from \"./AccountCard\";\n\nfunction FollowTab(props) {\n  const accountId = props.accountId;\n  const [account, setAccount] = useState(null);\n  const [follow, setFollow] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [gkey] = useState(uuid());\n\n  const showFollowers = props.showFollowers;\n  const hidden = props.hidden;\n\n  const fetchAccount = useCallback(async () => {\n    let account = await props._near.getAccount(accountId);\n    setAccount(account);\n    let list;\n    if (showFollowers) {\n      await account.fetchFollowers();\n      list = account.followers;\n    } else {\n      await account.fetchFollowings();\n      list = account.followings;\n    }\n    if (props.signedIn && props.signedAccountId !== accountId) {\n      const notFollowing = Object.keys(list).filter((accountId) => !(accountId in props.followings));\n      const following = Object.keys(list).filter((accountId) => (accountId in props.followings));\n\n      setFollow([...notFollowing, ...following]);\n    } else {\n      setFollow(Object.keys(list));\n    }\n  }, [accountId, props._near, props.followings, props.signedIn, props.signedAccountId, showFollowers])\n\n  useEffect(() => {\n    if (props.connected && !hidden && (!account || account.accountId !== accountId)) {\n      setLoading(true);\n      fetchAccount().then(() => setLoading(false))\n    }\n  }, [accountId, props.connected, hidden, account, fetchAccount]);\n\n\n  const list = follow.map((accountId) => {\n    const key = `${gkey}-f/${accountId}`;\n    return (\n      <div key={key} className=\"follower\">\n        <div className=\"card mb-3\">\n          <div className=\"card-body\">\n            <AccountCard  {...props} accountId={accountId}/>\n          </div>\n        </div>\n      </div>\n    );\n  });\n\n  return loading ? (\n      <div className=\"d-flex justify-content-center\">\n        <div className=\"spinner-grow\" role=\"status\">\n          <span className=\"visually-hidden\">Loading...</span>\n        </div>\n      </div>\n    ) : (list.length > 0) ? (\n    <div>\n      {list}\n    </div>\n    ) : (\n      <div className=\"text-muted\">No one is here</div>\n    );\n}\n\nexport default FollowTab;\n","import React, {useEffect, useState} from 'react';\nimport './Account.scss';\nimport {useParams} from \"react-router\";\nimport Feed from \"../components/Feed\";\nimport Followers from \"../components/Followers\";\nimport NewPost from \"../components/NewPost\";\nimport AccountCard from \"../components/AccountCard\";\nimport FollowTab from \"../components/FollowTab\";\n\nfunction AccountPage(props) {\n  const { accountId } = useParams();\n  const [seed, setSeed] = useState(false);\n\n  const [account, setAccount] = useState(null);\n\n  if (props.connected) {\n    props._near.getAccount(accountId).then((account) => {\n      setAccount(account);\n    })\n  }\n\n  useEffect(() => {\n    if (props.connected && account) {\n      setSeed([[account.stats.lastPostHeight, account.accountId]]);\n    }\n  }, [props.connected, account])\n\n  return (\n    <div className=\"container\">\n      <div className=\"row justify-content-md-center\">\n        <div className=\"col col-12 col-lg-8 col-xl-6\">\n          {props.connected && (\n            <div>\n              <AccountCard {...props} accountId={accountId} />\n              <div className=\"mb-3\"></div>\n              <ul className=\"nav nav-pills mb-2\" id=\"accountTab\" role=\"tablist\">\n                <li className=\"nav-item\" role=\"presentation\">\n                  <button className=\"nav-link active\" id=\"posts-tab\" data-bs-toggle=\"pill\" data-bs-target=\"#posts\"\n                          type=\"button\" role=\"tab\" aria-controls=\"home\" aria-selected=\"true\">{accountId === props.signedAccountId && \"Your \"} Posts\n                  </button>\n                </li>\n                <li className=\"nav-item\" role=\"presentation\">\n                  <button className=\"nav-link\" id=\"following-tab\" data-bs-toggle=\"pill\" data-bs-target=\"#following\" type=\"button\"\n                          role=\"tab\" aria-controls=\"profile\" aria-selected=\"false\">Following\n                  </button>\n                </li>\n                <li className=\"nav-item\" role=\"presentation\">\n                  <button className=\"nav-link\" id=\"followers-tab\" data-bs-toggle=\"pill\" data-bs-target=\"#followers\" type=\"button\"\n                          role=\"tab\" aria-controls=\"contact\" aria-selected=\"false\">Followers\n                  </button>\n                </li>\n              </ul>\n              <div className=\"tab-content\" id=\"myTabContent\">\n                <div className=\"tab-pane fade show active\" id=\"posts\" role=\"tabpanel\" aria-labelledby=\"posts-tab\">\n                  {accountId === props.signedAccountId && (\n                    <NewPost {...props}/>\n                  )}\n                  {seed ? (\n                    <Feed {...props} seed={seed}/>\n                  ) : (\n                    <div className=\"d-flex justify-content-center\">\n                      <div className=\"spinner-grow\" role=\"status\">\n                        <span className=\"visually-hidden\">Loading...</span>\n                      </div>\n                    </div>\n                  )}\n                </div>\n                <div className=\"tab-pane fade\" id=\"following\" role=\"tabpanel\" aria-labelledby=\"following-tab\">\n                  <FollowTab {...props} showFollowers={false} accountId={accountId} hidden={false}/>\n                </div>\n                <div className=\"tab-pane fade\" id=\"followers\" role=\"tabpanel\" aria-labelledby=\"followers-tab\">\n                  <FollowTab {...props} showFollowers={true} accountId={accountId} hidden={false}/>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n        <div className=\"col col-12 col-lg-4 col-xl-4\">\n          {props.signedIn && <Followers {...props} />}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default AccountPage;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n","import React from 'react';\nimport './Post.scss';\nimport AccountCard from \"./AccountCard\";\n\nfunction Followers(props) {\n  const notFollowing = Object.keys(props.followers).filter((accountId) => !(accountId in props.followings));\n\n  const followers = notFollowing.map((accountId) => {\n    const key = `f/${accountId}`;\n    return (\n      <div key={key} className=\"follower\">\n        <div className=\"card mb-3\">\n          <div className=\"card-body\">\n            <AccountCard accountId={accountId} {...props}/>\n          </div>\n        </div>\n      </div>\n    );\n  });\n\n  return !props.connected ? (\n    <div className=\"d-flex justify-content-center\">\n      <div className=\"spinner-grow\" role=\"status\">\n        <span className=\"visually-hidden\">Loading...</span>\n      </div>\n    </div>\n  ) : (followers.length > 0) ? (\n    <div>\n      <h3>Follow back</h3>\n      {followers}\n    </div>\n  ) : (\n    <div></div>\n  );\n}\n\nexport default Followers;\n","import React from 'react';\nimport './FollowButton.scss';\n\nfunction FollowButton(props) {\n  const accountId = props.accountId;\n  const account = props.account;\n\n  async function follow() {\n    if (!props.enoughStorageBalance) {\n      alert('Add storage balance to follow');\n      return;\n    }\n    if (!props.followings || (accountId in props.followings)) {\n      return;\n    }\n    props._near.accountData.followings[accountId] = account;\n    props.updateState({\n      followings: Object.assign({}, props._near.accountData.followings),\n    })\n    await props._near.contract.follow({account_id: accountId});\n  }\n\n  async function unfollow() {\n    if (!props.followings || !(accountId in props.followings)) {\n      return;\n    }\n    delete props._near.accountData.followings[accountId];\n    props.updateState({\n      followings: Object.assign({}, props._near.accountData.followings),\n    })\n    await props._near.contract.unfollow({account_id: accountId});\n  }\n\n  return (\n    <div className=\"follow-button mb-3\">\n      {(!account) ? (\n        <div className=\"spinner-grow\" role=\"status\">\n          <span className=\"visually-hidden\">Loading...</span>\n        </div>\n      ) : (accountId === props.signedAccountId) ? (\n        <div>It's you</div>\n      ) : (props.followings && (accountId in props.followings)) ? (\n        <button className=\"btn btn-primary btn-unfollow\" onClick={unfollow}><span>Following</span></button>\n      ) : (props.signedIn) ? (\n        <button\n          className=\"btn btn-outline-primary btn-follow\"\n          onClick={follow}\n          >Follow</button>\n      ) : (\n        <button\n          className=\"btn btn-outline-secondary btn-follow\"\n          disabled={true}\n          >Sign in to Follow</button>\n      )}\n    </div>\n  );\n}\n\nexport default FollowButton;\n","import React, {useCallback, useEffect, useState} from 'react';\nimport './Account.scss';\nimport {Link} from \"react-router-dom\";\nimport FollowButton from \"./FollowButton\";\nimport Account from \"./Account\";\nimport uuid from \"react-uuid\";\n\nfunction AccountCard(props) {\n  const [account, setAccount] = useState(null);\n  const [knownFollowers, setKnownFollowers] = useState([]);\n  const [newFollowing, setNewFollowing] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [followsYou, setFollowsYou] = useState(false);\n  const [key] = useState(uuid());\n\n  const hidden = props.hidden;\n  const accountId = props.accountId;\n\n  const fetchAccount = useCallback(async () => {\n    let account = await props._near.getAccount(accountId);\n    setAccount(account);\n    if (props.signedIn && props.signedAccountId !== accountId) {\n      setFollowsYou(accountId in props.followers);\n      account.fetchFollowers().then(() => {\n        setKnownFollowers(Object.keys(account.followers).filter((accountId) => (accountId in props.followings)));\n      });\n      account.fetchFollowings().then(() => {\n        setNewFollowing(Object.keys(account.followings).filter((accountId) => !(accountId in props.followings) && accountId !== props.signedAccountId));\n      });\n    }\n  }, [accountId, props._near, props.followings, props.signedIn, props.signedAccountId, props.followers])\n\n  useEffect(() => {\n    if (props.connected && !hidden && (!account || account.accountId !== accountId)) {\n      setLoading(true);\n      fetchAccount().then(() => setLoading(false))\n    }\n  }, [props.connected, accountId, hidden, account, fetchAccount]);\n\n  const followers = knownFollowers.slice(0, (knownFollowers.length === 4) ? 4 : 3).map(\n    (accountId, i) => (\n      <span key={`a-${key}-${accountId}`}>\n        {i > 0 && \", \"}\n        <Account {...props} accountId={accountId}/>\n      </span>\n    )\n  );\n\n  const followersAndOthers = knownFollowers.length - followers.length;\n\n  const following = newFollowing.slice(0, (newFollowing.length === 4) ? 4 : 3).map(\n    (accountId, i) => (\n      <span key={`b-${key}-${accountId}`}>\n        {i > 0 && \", \"}\n        <Account {...props} accountId={accountId}/>\n      </span>\n    )\n  );\n\n  const followingAndOthers = newFollowing.length - following.length;\n\n  return (\n    <div>\n      <div>\n        <h5><Link className=\"account-handle\" to={`/a/${accountId}`}>@{accountId}</Link></h5>\n      </div>\n      { loading ? (\n        <div className=\"d-flex justify-content-center\">\n          <div className=\"spinner-grow\" role=\"status\">\n            <span className=\"visually-hidden\">Loading...</span>\n          </div>\n        </div>\n      ) : account ? (\n        <div>\n          <FollowButton {...props} accountId={accountId} account={account}/>\n          <div className=\"mb-2\">\n            <div>\n              <span className=\"me-md-2\">\n                {account.stats.numPosts ? <b>{account.stats.numPosts}</b> : <span className=\"text-muted\">No</span>} <span className=\"text-muted\">post{account.stats.numPosts !== 1 && \"s\"}</span>\n              </span>\n              {followsYou && <span className=\"badge bg-secondary\">Follows You</span>}\n            </div>\n            <div>\n              <span className=\"me-md-2\"><b>{account.stats.numFollowing}</b> <span className=\"text-muted\">following</span></span>\n              <span><b>{account.stats.numFollowers}</b> <span className=\"text-muted\">followers</span></span>\n            </div>\n          </div>\n          {props.signedIn && accountId !== props.signedAccountId && (\n            <div>\n              <div className=\"text-muted\">\n                { followers.length > 0 ? (\n                  <div>\n                    Followed by {followers} {followersAndOthers ? ` and ${followersAndOthers} others you follow` : \"\"}\n                  </div>\n                ) : (\n                  \"Not followed by anyone you know\"\n                )}\n              </div>\n              { following.length > 0 && (\n                <div className=\"text-muted\">\n                  Follows {following} {followingAndOthers ? ` and ${followingAndOthers} others you don't follow` : \"\"}\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n      ) : (\n        <div>Error loading account</div>\n      )}\n    </div>\n  );\n}\n\nexport default AccountCard;\n","import React, {useCallback, useEffect, useState} from 'react';\nimport Post from \"./Post\";\nimport { SortedSet } from \"collections/sorted-set\";\n\nfunction Feed(props) {\n  const [loading, setLoading] = useState(true);\n  const [posts, setPosts] = useState([]);\n\n  const seed = props.seed;\n  const extraPosts = props.extraPosts || [];\n\n  const fetchPosts = useCallback(async () => {\n    const posts = [];\n    const recent = SortedSet(seed);\n    while (recent.length > 0 && posts.length < 30) {\n      const [blockHeight, accountId] = recent.pop();\n      if (blockHeight === 0) {\n        break;\n      }\n\n      const post = await props._near.getPost(accountId, blockHeight);\n      if (post) {\n        if (post.lastPostHeight > 0) {\n          recent.push([post.lastPostHeight, accountId])\n        }\n        posts.push(post);\n        setPosts([...posts]);\n      }\n    }\n  }, [seed, props._near])\n\n  useEffect(() => {\n    setLoading(true);\n    fetchPosts().then(() => setLoading(false))\n  }, [seed, fetchPosts]);\n\n  const feed = [...extraPosts, ...posts].map(post => {\n    const key = `${post.accountId}/${post.blockHeight}`;\n    return <Post key={key} post={post} {...props}/>;\n  });\n  return (\n    <div>\n      {(feed.length > 0) ? feed : !loading && (\n        <div className=\"text-muted\">\n          No posts.\n        </div>\n      )}\n      {loading && (\n        <div className=\"d-flex justify-content-center\">\n          <div className=\"spinner-grow\" role=\"status\">\n            <span className=\"visually-hidden\">Loading...</span>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default Feed;\n","import React, {useState} from 'react';\nimport './Account.scss';\nimport ReactTooltip from \"react-tooltip\";\nimport {Link} from \"react-router-dom\";\nimport AccountCard from \"./AccountCard\";\nimport uuid from \"react-uuid\";\n\nfunction Account(props) {\n  const [hidden, setHidden] = useState(true);\n  const [key] = useState(uuid());\n  const accountId = props.accountId;\n\n  return (\n    <div className=\"account\">\n      <Link className=\"account-handle\" data-tip data-for={key} to={`/a/${accountId}`}>@{accountId}</Link>\n      <ReactTooltip\n        id={key}\n        type=\"light\"\n        border={true}\n        borderColor='rgb(222, 236, 230)'\n        className='account-tooltip'\n        delayHide={100}\n        delayShow={200}\n        effect='solid'\n        afterShow={() => setHidden(false)}\n        afterHide={() => setHidden(true)}\n      >\n        <AccountCard {...props} accountId={accountId} hidden={hidden} />\n\n      </ReactTooltip>\n    </div>\n  );\n}\n\nexport default Account;\n","import React, {useState} from 'react';\nimport {convertPost} from \"../data/Post\";\nimport AddStorageButton from \"./AddStorageButton\";\n\nfunction NewPost(props) {\n  const [ body, setBody ] = useState(\"\");\n  const [ loading, setLoading ] = useState(false);\n\n  const post = async () => {\n    let _body = body;\n    setLoading(true);\n    setBody(\"\");\n    let newPosts = convertPost(await props._near.contract.post({body: _body}));\n    newPosts.accountId = props.signedAccountId;\n    props.updateState({\n      newPosts: [...props.newPosts, newPosts]\n    })\n    setLoading(false);\n  };\n\n  return props.enoughStorageBalance ? (\n    <div>\n      <form>\n        <div className=\"mb-3\">\n          <textarea\n            className=\"form-control\" placeholder={\"New post\"} rows=\"5\" value={body}\n            onChange={(e) => setBody(e.target.value)}\n          />\n        </div>\n        <div className=\"mb-3 d-grid gap-2 d-md-flex justify-content-md-end\">\n          <button className=\"btn btn-primary\" disabled={!body} onClick={post}>\n            {loading ? (\n              <span>\n                <span className=\"spinner-grow spinner-grow-sm\" role=\"status\" aria-hidden=\"true\"></span>\n                <span className=\"visually-hidden\">Loading...</span>\n                {' '}Posting\n              </span>\n            ) : (\n              <span>Post now</span>\n            )}\n          </button>\n        </div>\n      </form>\n    </div>\n  ) : (\n    <div className=\"mb-3\">\n      <div>\n        <div className=\"alert alert-danger\" role=\"alert\">\n          <b>Not enough storage balance!</b><br/>\n          Add storage balance to be able to post and follow people.\n        </div>\n      </div>\n      <div>\n        <AddStorageButton {...props}/>\n      </div>\n    </div>\n  );\n}\n\nexport default NewPost;\n","const convertPost = (post) => {\n  return {\n    body: post.body,\n    time: new Date(parseFloat(post.time) / 1_000_000),\n    blockHeight: post.block_height,\n    lastPostHeight: post.last_post_height,\n  };\n};\n\nclass PostData {\n  constructor(_near, accountId, requestBlockHeight) {\n    this._near = _near;\n    this.accountId = accountId;\n    this.requestBlockHeight = requestBlockHeight;\n    this._ready = false;\n  }\n\n  static async load(_near, accountId, requestBlockHeight) {\n    let post = new PostData(_near, accountId, requestBlockHeight);\n    await post.fetch();\n    return post;\n  }\n\n\n  async fetch() {\n    const post = await this._near.blockViewCall(this.requestBlockHeight, 'get_post', {account_id: this.accountId});\n    if (post) {\n      Object.assign(this, convertPost(post));\n    }\n    this._ready = true;\n  }\n}\n\nexport {PostData, convertPost};\n","import React from 'react';\n\nfunction AddStorageButton(props) {\n  async function requestStorageBalance(e) {\n    e.preventDefault();\n    await props._near.contract.storage_deposit({}, \"30000000000000\", \"100000000000000000000000\");\n  }\n\n  return !props.enoughStorageBalance && (\n    <button\n      className=\"btn btn-primary me-md-2\"\n      onClick={requestStorageBalance}\n    >\n      Add storage balance\n    </button>\n  );\n}\n\nexport default AddStorageButton;\n","import React from 'react';\nimport './Post.scss';\nimport Account from \"./Account\";\nimport TimeAgo from \"timeago-react\";\nimport {Link} from \"react-router-dom\";\n\nfunction Post(props) {\n  const post = props.post;\n  return (\n    <div className=\"card mb-3\">\n      <div className=\"card-body\">\n        <h5 className=\"card-title\"><Account {...props} accountId={post.accountId} /></h5>\n        <h6 className=\"card-subtitle mb-2 text-muted\">\n          <Link className=\"post-link\" to={`/p/${post.accountId}/${post.blockHeight}`}><TimeAgo datetime={post.time} /></Link>\n        </h6>\n        <div className=\"card-text\">\n          {post.body}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default Post;\n","import BN from \"bn.js\";\n\nconst MinEnoughStorageBalance = new BN(\"50000000000000000000000\");\nconst FetchLimit = 100;\n\nconst convertAccountStats = (accountStats) => {\n  return {\n    numPosts: accountStats.num_posts,\n    numFollowers: accountStats.num_followers,\n    numFollowing: accountStats.num_following,\n    lastPostHeight: accountStats.last_post_height,\n  };\n};\n\nclass AccountData {\n  constructor(_near, accountId, accountStats) {\n    this._near = _near;\n    this.accountId = accountId;\n    this.stats = {\n      lastPostHeight: 0,\n      numFollowers: 0,\n      numFollowing: 0,\n      numPosts: 0,\n      enoughStorageBalance: false,\n    };\n    if (accountStats) {\n      Object.assign(this.stats, convertAccountStats(accountStats));\n      this._ready = true;\n    } else {\n      this._ready = false;\n    }\n    this.followings = false;\n    this.followers = false;\n    this._near.cacheAccount(accountId, this);\n  }\n\n  static async load(_near, accountId) {\n    let account = new AccountData(_near, accountId);\n    await account.fetchAccountStats();\n    return account;\n  }\n\n  async fetchStorageBalance() {\n    let storageBalance = await this._near.contract.storage_balance_of({account_id: this.accountId});\n    this.stats.storageTotal = new BN(storageBalance.total);\n    this.stats.storageAvailable = new BN(storageBalance.available);\n    this.stats.enoughStorageBalance = this.stats.storageAvailable > MinEnoughStorageBalance;\n  }\n\n  async fetchAccountStats() {\n    const accountStats = await this._near.contract.get_account({account_id: this.accountId});\n    if (accountStats) {\n      Object.assign(this.stats, convertAccountStats(accountStats));\n      this._ready = true;\n    }\n  }\n\n  async fetchFollowings() {\n    if (this.followings !== false) {\n      await this.followingsFetch;\n      return;\n    }\n    const promises = [];\n    for (let i = 0; i < this.stats.numFollowing; i += FetchLimit) {\n      promises.push(this._near.contract.get_following({\n        account_id: this.accountId,\n        from_index: i,\n        limit: FetchLimit,\n      }));\n    }\n    this.followings = {};\n    this.followingsFetch = new Promise(async (resolve) => {\n      (await Promise.all(promises)).flat().forEach(([accountId, accountStats]) => {\n        this.followings[accountId] = new AccountData(this._near, accountId, accountStats);\n      });\n      resolve();\n    });\n    await this.followingsFetch;\n  }\n\n  async fetchFollowers() {\n    if (this.followers !== false) {\n      await this.followersFetch;\n      return;\n    }\n    const promises = [];\n    for (let i = 0; i < this.stats.numFollowers; i += FetchLimit) {\n      promises.push(this._near.contract.get_followers({\n        account_id: this.accountId,\n        from_index: i,\n        limit: FetchLimit,\n      }));\n    }\n    this.followers = {};\n    this.followersFetch = new Promise(async (resolve) => {\n      (await Promise.all(promises)).flat().forEach(([accountId, accountStats]) => {\n        this.followers[accountId] = new AccountData(this._near, accountId, accountStats);\n      });\n      resolve();\n    });\n    await this.followersFetch;\n  }\n}\n\nexport {AccountData, convertAccountStats};\n","import \"./Home.scss\";\nimport React, {useCallback, useEffect, useState} from 'react';\nimport Feed from \"../components/Feed\";\nimport {AccountData} from \"../data/Account\";\nimport Followers from \"../components/Followers\";\n\nconst FetchLimit = 100;\n\nfunction DiscoverPage(props) {\n  const [seed, setSeed] = useState(false);\n\n  const fetchSeed = useCallback(async () => {\n    if (props.connected) {\n      const numAccounts = await props._near.contract.get_num_accounts();\n      return (await props._near.contract.get_accounts({\n        from_index: Math.max(numAccounts - FetchLimit, 0),\n        limit: FetchLimit\n      })).map(([accountId, accountStats]) => {\n        let account = new AccountData(props._near, accountId, accountStats);\n        return [account.stats.lastPostHeight, accountId]\n      });\n    } else {\n      return false;\n    }\n  }, [props.connected, props._near])\n\n  useEffect(() => {\n    fetchSeed().then(setSeed);\n  }, [fetchSeed]);\n\n\n  return (\n    <div>\n      <div className=\"container\">\n        <div className=\"row justify-content-md-center\">\n          <div className=\"col col-12 col-lg-8 col-xl-6\">\n            {seed && seed.length > 0 && (\n              <div>\n                <h3>Discover</h3>\n                <Feed {...props} seed={seed}/>\n              </div>\n            )}\n            {!seed && (\n              <div className=\"d-flex justify-content-center\">\n                <div className=\"spinner-grow\" role=\"status\">\n                  <span className=\"visually-hidden\">Loading...</span>\n                </div>\n              </div>\n            )}\n          </div>\n          <div className=\"col col-12 col-lg-4 col-xl-4\">\n            {props.signedIn && <Followers {...props} />}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default DiscoverPage;\n"],"sourceRoot":""}